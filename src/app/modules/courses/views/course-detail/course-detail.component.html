<section class="course-jumbotron">
  <div class="course-jumbotron-wrapper">
    <div class="course-jumbotron-overlay">
      <div  *ngIf="course" class="course-jumbotron-container">
        <div class="top-container">
          <div class="category-container">
            <div
              class="category-indicator"
              [style.backgroundColor]="course.category.hexColor"
            ></div>
            <div class="category-name-container">
              <div class="category-name">{{ course.category.name }}</div>
            </div>
          </div>
          <div class="favorite-container">
            <div *ngIf="isFavorite" class="isFavorite">
              <i class="material-icons">
                favorite
              </i>
            </div>
            <div *ngIf="!isFavorite" class="notFavorite">
              <i class="material-icons">
                favorite_border
              </i>
            </div>
          </div>
        </div>
        <div class="middle-container">
          <div class="course-image-section">
            <div class="image-wrapper">
              <div
                class="course-image-container"
                [style.backgroundImage]="'url(' + course.imgUrl + ')'"
              >
                <div class="image-overlay"></div>
              </div>
            </div>
          </div>
          <div class="course-name">{{ course.name }}</div>
          <div class="buttons-container">
            <button *ngIf="!enrolled && !showGoToCart" class="enroll-button focus-outline" (click)="onAddToCart(course.id)">Add to cart <i class="material-icons">add_shopping_cart</i></button>
            <button *ngIf="!enrolled && showGoToCart" class="enroll-button focus-outline" [routerLink]="['/courses/cart']">Go to cart <i class="material-icons">shopping_cart</i></button>
            <button *ngIf="!enrolled" class="buy-now-button focus-outline" (click)="onBuyNow()">Buy now</button>
            <button *ngIf="enrolled" class="enroll-button focus-outline" tabindex="0" [routerLink]="['./learn']">Learn Now <i class="material-icons">arrow_forward_ios</i></button>
          </div>
        </div>
        <div class="bottom-container">
          <div class="price-container">
            <div *ngIf="course.price === 0" class="free-container">
              <div class="free">Free</div>
            </div>
            <div *ngIf="course.price > 0" class="price">
              {{ course.price | currency: 'NGN':'symbol-narrow' }}
            </div>
          </div>
          <div *ngIf="course.rating" class="rating-container">
            <i class="material-icons">star</i>
            <div>{{ course.rating }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="tabs-section">
  <div class="tabs-container">
    <a
      class="tab-selector focus-outline"
      [class.active]="currentTab === 'about'"
      (click)="currentTab = 'about'"
      tabindex="0"
      [routerLink]="['./']"
      fragment="about"
    >
      About
    </a>
    <a
      class="tab-selector focus-outline"
      [class.active]="currentTab === 'lessons'"
      (click)="currentTab = 'lessons'"
      tabindex="0"
      [routerLink]="['./']"
      fragment="lessons"
    >
      Lessons
    </a>
    <a
      class="tab-selector focus-outline"
      [class.active]="currentTab === 'reviews'"
      (click)="currentTab = 'reviews'"
      tabindex="0"
      [routerLink]="['./']"
      fragment="reviews"
    >
      Reviews
    </a>
    <a
      *ngIf="showCertificateTab"
      class="tab-selector focus-outline"
      [class.active]="currentTab === 'certificate'"
      (click)="currentTab = 'certificate'"
      tabindex="0"
      [routerLink]="['./']"
      fragment="certificate"
    >
      Certificate
    </a>
  </div>
</section>

<section class="tab-content-section">
  <div *ngIf="course" class="tab-content-container">
    <!-- About tab content -->
    <div *ngIf="currentTab === 'about'" class="tab tab-about">
      <div class="description-title">Course overview</div>
      <div class="description-content" [innerHTML]="course.overview"></div>
    </div>
    <!-- Lessons tab content -->
    <div *ngIf="currentTab === 'lessons'" class="tab tab-lessons">
      <div class="lessons-title">{{ course.lessons.length }} lessons</div>
      <div class="lessons-container">
        <div
          class="lesson-card"
          *ngFor="let lesson of course.lessons; let i = index"
        >
          <app-lesson-card
            [lesson]="lesson"
            [lessonNumber]="i + 1"
          ></app-lesson-card>
        </div>
      </div>
    </div>
    <!-- Reviews tab content -->
    <div *ngIf="currentTab === 'reviews'" class="tab tab-reviews">
      <div *ngIf="course.totalReviews" class="reviews-title">{{ course.totalReviews }} reviews</div>
      <div *ngIf="!(course.totalReviews) || course.totalReviews === 0" class="reviews-title">0 reviews</div>
      <div class="reviews-container">
        <div
          class="review-card"
          *ngFor="let review of course.reviews; let i = index"
        >
          <app-review-card
            [review]="review"
            [reviewNumber]="i + 1"
          ></app-review-card>
        </div>
      </div>
    </div>
    <!-- Certificate tab content -->
    <div
      *ngIf="currentTab === 'certificate' && showCertificateTab && showCertificate"
      class="tab tab-certificate"
    >
      <div class="certificate-wrapper">
        <div id="certificate" class="certificate">
          <div class="certificate-container">
            <img alt="Invest Naija Logotype" class="logotype" src="/assets/img/logos/logotype-certificate.svg">
            <div class="certificate-label">certificate</div>
            <div class="awarded-container">
              <div class="line"></div>
              <div class="awarded-label">this certificate is awarded to</div>
              <div class="line"></div>
            </div>
            <div class="name">
              <div class="user-names">{{user.name}} {{user.lastName}}</div>
              <div class="line name-line"></div>
            </div>
            <div class="course-details">
              <div class="course-data course-category">
                <div class="course-data-label">course category:</div>
                <div class="course-data-input">
                  <div class="course-value">{{course.category.name}}</div>
                  <div class="input-line"></div>
                </div>
              </div>
              <div class="course-data course-name">
                <div class="course-data-label">course name:</div>
                <div class="course-data-input">
                  <div class="course-value">{{course.name}}</div>
                  <div class="input-line"></div>
                </div>
              </div>
              <div class="course-data course-date">
                <div class="course-data-label">date:</div>
                <div class="course-data-input">
                  <div class="course-value">{{course.category.createdAt}}</div>
                  <div class="input-line"></div>
                </div>
              </div>
              <div class="course-data course-url">
                <div class="course-data-label">url:</div>
                <div class="course-data-input">
                  <div class="course-value">https://investnaija.com/courses/{{course.id}}</div>
                  <div class="input-line"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <button class="download-certificate-button focus-outline" (click)="onDownloadCertificate()">Download certificate</button>
    </div>
    <div
      *ngIf="currentTab === 'certificate' && showCertificateTab && !showCertificate"
      class="tab tab-no-certificate"
    >
      <div class="reviews-container no-certificate">
        <i class="material-icons">inbox</i>
        <div class="complete-phrase">Complete this course to download your certificate</div>
      </div>
    </div>
  </div>
</section>

<div class="divider"></div>

<section *ngIf="relatedCourses && relatedCourses.length > 0" class="courses-section">
  <div class="courses-container">
    <div class="title-container">
      <div class="title">You might also be interested in</div>
      <a>View all</a>
    </div>
    <div class="cards-container">
      <div
        class="course-card"
        *ngFor="let course of relatedCourses; let i = index"
      >
        <app-course-card [course]="course"></app-course-card>
      </div>
    </div>
  </div>
</section>
